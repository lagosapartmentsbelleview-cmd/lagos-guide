<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <title>Gestão de Reservas</title>

    <!-- CSS Global -->
    <link rel="stylesheet" href="css/base.css">

    <!-- CSS Específico da Listagem -->
    <link rel="stylesheet" href="css/reservas.css">
</head>

<body>

<div class="container">

    <!-- TOPO -->
    <div id="topoReservas">
        <h1>Gestão de Reservas</h1>

        <div>
            <button id="btnNovaReserva" class="btn btn-primario">+ Nova Reserva</button>
            <button id="btnImportarExcel" class="btn btn-secundario">Importar Excel</button>
            <button id="btnIrCalendario" class="btn btn-primario">Ir para Calendário</button>
        </div>
    </div>

    <!-- INPUT INVISÍVEL PARA IMPORTAÇÃO -->
    <input type="file" id="inputExcel" accept=".xlsx,.xls" style="display:none">

    <!-- FILTROS AVANÇADOS -->
    <div id="filtrosWrapper">

        <div class="filtros-linha">
            <div class="filtro">
                <label>Origem</label>
                <select id="filtroOrigem">
                    <option value="">Todas</option>
                    <option value="Booking">Booking</option>
                    <option value="Airbnb">Airbnb</option>
                    <option value="Particular">Particular</option>
                    <option value="VRBO">VRBO</option>
                    <option value="Expedia">Expedia</option>
                    <option value="Agoda">Agoda</option>
                    <option value="Hotels">Hotels</option>
                    <option value="Trip">Trip</option>
                </select>
            </div>

            <div class="filtro">
                <label>Estado da Reserva</label>
                <select id="filtroEstado">
                    <option value="">Todos</option>
                    <option value="alocado">Alocado</option>
                    <option value="sem_alocacao">Sem Alocação</option>
                </select>
            </div>

            <div class="filtro">
                <label>Pagamento</label>
                <select id="filtroPagamento">
                    <option value="">Todos</option>
                    <option value="total">Pago Total</option>
                    <option value="parcial">Parcial</option>
                    <option value="pendente">Pendente</option>
                </select>
            </div>

            <div class="filtro">
                <label>Apartamento</label>
                <select id="filtroApartamento">
                    <option value="">Todos</option>
                    <option value="2301">2301</option>
                    <option value="2203">2203</option>
                    <option value="2204">2204</option>
                </select>
            </div>
        </div>

        <div class="filtros-linha">
            <div class="filtro">
                <label>Hóspede</label>
                <input type="text" id="filtroHospede" placeholder="Pesquisar nome...">
            </div>

            <div class="filtro">
                <label>Check-in (Ano)</label>
                <select id="filtroAnoInicio"></select>
            </div>

            <div class="filtro">
                <label>Check-in (Mês)</label>
                <select id="filtroMesInicio"></select>
            </div>

            <div class="filtro">
                <label>Check-out (Ano)</label>
                <select id="filtroAnoFim"></select>
            </div>

            <div class="filtro">
                <label>Check-out (Mês)</label>
                <select id="filtroMesFim"></select>
            </div>
        </div>

        <button id="btnLimparFiltros" class="btn btn-secundario">Limpar Filtros</button>
    </div>

    <!-- TABELA DE RESERVAS -->
    <table id="tabelaReservas">
        <thead>
            <tr>
                <th><input type="checkbox" id="selectAll"></th>
                <th>Origem</th>
                <th>ID</th>
                <th>Cliente</th>
                <th>Pais</th>
                <th>Apt</th>
                <th>Noites</th>
                <th>Check-in</th>
                <th>Check-out</th>
                <th>Total</th>
                <th>Pago</th>
                <th>Estado</th>
                <th>Ações</th>
            </tr>
        </thead>
        <tbody id="listaReservas"></tbody>
    </table>

    <!-- AÇÕES EM MASSA -->
    <div class="mt-20">
        <button id="btnApagarSelecionadas" class="btn btn-perigo">Apagar Selecionadas</button>
        <button id="btnEnviarCalendario" class="btn btn-primario">Enviar para Calendário</button>
        <button id="btnMarcarPagas" class="btn btn-secundario">Marcar como Pagas</button>
    </div>

</div>

<!-- MODAL DE RESERVA -->
<div id="modalReserva" class="modal">
    <div class="modal-content">
        <span id="fecharModal" class="modal-close">&times;</span>
        <h2>Reserva</h2>

        <div id="formReserva"></div>

        <button id="btnGuardar" class="btn btn-primario mt-20">Guardar</button>
        <button id="btnApagar" class="btn btn-perigo mt-10">Apagar</button>
    </div>
</div>

<!-- MODAL DE RESERVAS DESAPARECIDAS -->
<div id="modalDesaparecidas" class="modal">
    <div class="modal-content">
        <span onclick="fecharModalDesaparecidas()" class="modal-close">&times;</span>
        <h2>Reservas Removidas do Excel</h2>
        <div id="listaDesaparecidas"></div>
        <button onclick="confirmarApagarDesaparecidas()" class="btn btn-perigo mt-20">Apagar Selecionadas</button>
    </div>
</div>

<!-- FIREBASE -->
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>

<script src="js/firebase-config.js"></script>

<script>
firebase.auth().onAuthStateChanged(user => {
    if (!user) window.location.href = "login.html";
});
</script>

<!-- JS PRINCIPAL DA LISTAGEM -->
<script src="js/reservas-listagem.js"></script>

</body>
</html>
