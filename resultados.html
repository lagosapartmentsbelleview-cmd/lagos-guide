<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <title>Resultados</title>

    <link rel="stylesheet" href="css/global.css">
    <link rel="stylesheet" href="css/resultados.css">
</head>

<body>

    <div class="top-menu">
        <span class="menu-button" id="toggleMenu">‚ò∞ Menu</span>

        <div class="dropdown-menu" id="dropdown-menu">
            <a href="listagem-reservas.html">Reservas</a>
            <a href="calendario.html">Calendario</a>
            <a href="limpeza.html">Limpeza</a>
            <a href="precos.html">Pre√ßos</a>
            <span class="menu-ativo">Resultados</span>
            <a href="login.html" class="sair">Sair</a>
        </div>
    </div>

    <div class="content">

        <h1>Resultados e Estat√≠sticas</h1>

        <!-- BOT√ïES DE MODO -->
        <div class="modo-toggle">
            <button id="btnFinanceiro" class="modo-btn ativo">üí∞ Financeiro</button>
            <button id="btnOperacional" class="modo-btn">üìä Operacional</button>
        </div>

        <!-- FILTROS -->
        <div class="filtros-resultados">
            <label>Ano:</label>
            <select id="filtroAno"></select>

            <label>M√™s:</label>
            <select id="filtroMes">
                <option value="">Todos</option>
                <option value="1">Janeiro</option>
                <option value="2">Fevereiro</option>
                <option value="3">Mar√ßo</option>
                <option value="4">Abril</option>
                <option value="5">Maio</option>
                <option value="6">Junho</option>
                <option value="7">Julho</option>
                <option value="8">Agosto</option>
                <option value="9">Setembro</option>
                <option value="10">Outubro</option>
                <option value="11">Novembro</option>
                <option value="12">Dezembro</option>
            </select>

            <label>Compar por:</label>
            <select id="tipoComparacao">
                <option value="bruto">Receita Bruta</option>
                <option value="liquido">Receita L√≠quida</option>
            </select>

            <button id="btnAplicarFiltros">Aplicar</button>
        </div>

        <!-- KPIs PRINCIPAIS -->
        <div class="kpi-container">

            <div class="kpi-card">
                <h3>Receita Bruta</h3>
                <p id="kpiReceitaBruta">0 ‚Ç¨</p>
            </div>

            <div class="kpi-card">
                <h3>Receita L√≠quida</h3>
                <p id="kpiReceitaLiquida">0 ‚Ç¨</p>
            </div>

            <div class="kpi-card">
                <h3>Ocupa√ß√£o</h3>
                <p id="kpiOcupacao">0%</p>
            </div>

            <div class="kpi-card">
                <h3>Pre√ßo M√©dio por Noite</h3>
                <p id="kpiPrecoMedio">0 ‚Ç¨</p>
            </div>

            <div class="kpi-card">
                <h3>Lucro</h3>
                <p id="kpiLucro">0 ‚Ç¨</p>
            </div>

            <!-- KPI extra s√≥ usado no modo operacional -->
            <div class="kpi-card" id="kpiRevparCard">
                <h3>RevPAR</h3>
                <p id="kpiRevpar">0 ‚Ç¨</p>
            </div>

        </div>

        <!-- GR√ÅFICOS -->
        <div class="card">
            <h3>Receita Mensal</h3>
            <canvas id="graficoReceita"></canvas>
        </div>

        <div class="card">
            <h3>Ocupa√ß√£o Mensal</h3>
            <canvas id="graficoOcupacao"></canvas>
        </div>

        <div class="card">
            <h3>Distribui√ß√£o de Custos</h3>
            <canvas id="graficoCustos"></canvas>
        </div>

        <div class="card">
            <h3>Compara√ß√£o Entre Anos</h3>
            <canvas id="graficoComparacao"></canvas>
        </div>

        <!-- TABELA MENSAL (usa financeiro ou operacional consoante o modo) -->
        <div class="card">
            <h3>Estat√≠sticas Mensais</h3>
            <table id="tabelaMensal">
                <thead>
                    <tr>
                        <th>M√™s</th>
                        <th>Receita Bruta</th>
                        <th>Custos</th>
                        <th>Receita L√≠quida</th>
                        <th>Ocupa√ß√£o</th>
                        <th>Pre√ßo M√©dio</th>
                        <!-- No modo operacional, o JS acrescenta RevPAR na √∫ltima coluna -->
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>

        <!-- TABELA ANUAL FINANCEIRA (comparativa por m√™s vs anos) -->
        <div class="card">
            <h3>Estat√≠sticas Anuais (Financeiro)</h3>
            <table id="tabelaAnual">
                <thead></thead>
                <tbody></tbody>
            </table>
        </div>

        <!-- CARD EVOLU√á√ÉO PRE√áO M√âDIO (s√≥ modo operacional) -->
        <div class="card" id="cardEvolucaoPrecoMedio" style="display:none;">
            <h3>Evolu√ß√£o do Pre√ßo M√©dio por Noite</h3>
            <table id="tabelaEvolucaoPrecoMedio">
                <thead></thead>
                <tbody></tbody>
            </table>
        </div>

        <!-- BOT√ÉO MOSTRAR MAIS (s√≥ modo operacional) -->
        <div class="card" id="cardMostrarMaisOperacional" style="display:none;">
            <button id="btnMostrarMais">Mostrar mais estat√≠sticas operacionais</button>
        </div>

        <!-- TABELA ANUAL OPERACIONAL (escondida at√© clicar) -->
        <div class="card" id="cardTabelaAnualOperacional" style="display:none;">
            <h3>Estat√≠sticas Anuais (Operacional)</h3>
            <table id="tabelaAnualOperacional">
                <thead></thead>
                <tbody></tbody>
            </table>
        </div>

        <!-- TABELA DE CUSTOS (escondida at√© clicar) -->
        <div class="card" id="cardTabelaCustos" style="display:none;">
            <h3>Tabela de Custos</h3>
            <table id="tabelaCustos">
                <thead></thead>
                <tbody></tbody>
            </table>
        </div>

        <!-- LEGENDA EXPLICATIVA -->
        <div class="card">
            <h3>Legenda e Explica√ß√£o dos C√°lculos</h3>

            <p><strong>Receita Bruta:</strong> Soma de todas as reservas no per√≠odo selecionado.</p>
            <p><strong>Custos:</strong> Comiss√µes, limpezas e outros custos associados √†s reservas.</p>
            <p><strong>Receita L√≠quida:</strong> Receita Bruta menos custos vari√°veis.</p>
            <p><strong>Ocupa√ß√£o:</strong> (Noites ocupadas / Noites dispon√≠veis) √ó 100.</p>
            <p><strong>Pre√ßo M√©dio por Noite:</strong> Receita Bruta / Noites ocupadas.</p>
            <p><strong>Lucro:</strong> Receita L√≠quida (podes depois subtrair custos fixos se quiseres).</p>
            <p><strong>RevPAR:</strong> Receita Bruta / Noites dispon√≠veis (modo operacional).</p>
        </div>

    </div>

    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>

    <script src="js/firebase-config.js"></script>
    <script src="js/menu.js"></script>

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- JS dos Resultados -->
    <script src="js/resultados.js"></script>

</body>
</html>
